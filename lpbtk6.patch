From 528e48be365603e4227ffc5b2ae32e2cf096dc1a Mon Sep 17 00:00:00 2001
From: sethyx <sethyx@gmail.com>
Date: Mon, 2 Apr 2012 20:42:21 +0200
Subject: [PATCH] dont handle back after kill

---
 .../com/android/internal/policy/impl/PhoneWindowManager.java    |    7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/policy/src/com/android/internal/policy/impl/PhoneWindowManager.java b/policy/src/com/android/internal/policy/impl/PhoneWindowManager.java
index f4d30de..d9c9b73 100755
--- a/policy/src/com/android/internal/policy/impl/PhoneWindowManager.java
+++ b/policy/src/com/android/internal/policy/impl/PhoneWindowManager.java
@@ -1740,8 +1740,11 @@ public long interceptKeyBeforeDispatching(WindowState win, KeyEvent event, int p
         }
 
         if (keyCode == KeyEvent.KEYCODE_BACK && !down) {
-            mHandler.removeCallbacks(mBackLongPress);
-            mBackJustKilled = false;
+            if ((flags&KeyEvent.FLAG_CANCELED) == 0) {
+                mHandler.removeCallbacks(mBackLongPress);
+                KeyEvent.changeFlags(event, flags + KeyEvent.FLAG_CANCELED);
+                mBackJustKilled = false;
+            }
         }
 
         // First we always handle the home key here, so applications
-- 
1.7.10

